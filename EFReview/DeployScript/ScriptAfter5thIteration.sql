DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'EFReview.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201806281055589_InitialModel'
BEGIN
    CREATE TABLE [dbo].[Genres] (
        [Id] [tinyint] NOT NULL,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Videos] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [ReleaseDate] [datetime] NOT NULL,
        CONSTRAINT [PK_dbo.Videos] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoGenres] (
        [Video_Id] [int] NOT NULL,
        [Genre_Id] [tinyint] NOT NULL,
        CONSTRAINT [PK_dbo.VideoGenres] PRIMARY KEY ([Video_Id], [Genre_Id])
    )
    CREATE INDEX [IX_Video_Id] ON [dbo].[VideoGenres]([Video_Id])
    CREATE INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]([Genre_Id])
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201806281055589_InitialModel', N'EFReview.Migrations.Configuration',  0x1F8B0800000000000400DD59CD6EE33610BE17E83B083AB545D64AB29736B0779175E2C2E8E6077112F41630D2D8214A512A49B9768B3E590F7DA4BE4287FA172959B2BBC8B64580C026E77F3E0E67E8BFFEF873FC7E1332670D42D2884FDC93D1B1EB00F7A380F2D5C44DD4F2CDB7EEFB775F7E31BE0CC28DF358D0BDD574C8C9E5C47D512A3EF33CE9BF4048E428A4BE8864B454233F0A3D1244DEE9F1F177DEC9890728C245598E33BE4BB8A221A45FF0EB34E23EC42A21EC2A0A80C97C1D7716A954E79A842063E2C3C4BD9CDDC19AC22FAE73CE2841FD0B604BD7219C478A28B4EEEC41C2428988AF16312E1076BF8D01E9968449C8AD3EABC8873A707CAA1DF02AC642949F4815857B0A3C799B47C433D90F8AAB5B460C637689B1555BED751AB789FB3D70819E9B9ACEA64C68AA2AA6A394F2C829BE1F95194760E8BF23679A3095089870489420ECC8B94D9E19F57F80ED7DF413F0094F18AB5B83F6E05E6301976E45148350DB3B58E636CE03D7F19A7C9EC958B2D57832073E6C153A788DBAC9338332D7DE4E76FDBF10808041C4BBCE15D97C04BE522F13173FBACE8C6E20285672A90F9CE201412625125BC93559D3551A5F43DD230D2092AE73072CDD962F34CED03B4AB79ED2E023C14C44E15DC40A967CFDE99E88152834386AD95C4489F00D63C65E85849DF848250DC2474AF91FC4C79CABB7A72D00A939BB5091008C2608A220B8254A81E05A06A4E1FA3C60329420748048B820AAD4A53FDFD37000FA3B8159E0EE506016D86B056681DA21C03C9732F2696A431D9985FEA63B973C7076199365A27402B381C8A4316211354FDC6FACF874082C8F5D2530AFA73B058EBD9A37F6E9C31B4F118A60AB1CFD355D848D6A398978A5E58751E648316DD74217A08C9456716E9A6EB9DE642F4A95C59E87D260AF796AC828A1532369839679FE7B925BDA5B99EA0D1451A4B326A2B0D12C2F4DB75AF05B26B1EA57BCAC61291A1BAFA3B3195F9138C61A51EB74F2156791B539D3378BFD3B813093E1F9B2A52128AD2D3561C5232B307651355A3AA3422AAC2DE499E852320D428BAC01D90E3C15AA1AA8B43355A0AC20D79F3396666762B256619BA1272156EAD42930936BF3A5AD256144B45C19D3882521EFBA7676716797409D3F5BB1258C3DC37033289E1515039D668C0765203F2D0765203BFBFB67A083EF7367A04B42E38EAD0B6A6CBC7E469BD5A825AD65ADEDCA5D49D09AA1D683A2AB685B1B6B14643B1883529B896A4BB00E46A9784F9BF20A7FA04DA9903D6D32AF0A3B7FD68D619294E8296F0EE38618E7D5BA7F40B6CA7746E23A68FB1A0385A57BB1950AC29126182D7E66534611AF15C115E1740952651DBB8BD3EAA9316DFF7B265F4FCA800D197F5F7DE650946FA90EEB3F184BF99A08FF8588AF42B2F9BA2EC99E16F69CF65E3D1C69287A87ACD789D5A0C92AC0CFAA7FB2DA2FEE07637147ADB489BB8A587FBE2A35B5AC59E3C89C07B099B8BFA54C67CEFCC7A782EFC8B9115841CE9C63E7F7BDB359996D9CA0010614BC7B1870D818DA7AE799D346FFFC79625DB537FC0241A8C039F7B3623A25D227811D357D0FEDD49E0F79A60943C656FD360B4B10FA3C1286D79554022F2CAB99B91594FB3426ACE1B57DE70EA922DAA5529EB9730131705D1E6C078768DBD56294A28DF0F605A073B4EF014E5B63524B9D9DB5D684FDCF80333C95AF0B9C5D7DE027074EFB9B903D870F78F4E97EF3C9DA40BCD79E7579CAAA62C7D347EB7B50F773509BE4F6779976C95D86D7373B7574B8D0FB26553E26ED7E9AEA1871EC826F4DBCBD4F520DB7CD416CF86BD420678B67AF1E67DB6727BB48590F2CAFE5EC1E4F6FF6C08427B4F6BB23560849579508FD2B2407BF71364B9A395F464591302C2A488C66E60A14C116929C0B4597C457B8ED8394E90F038F84257A3C0F9F2198F39B44C5894297217C668D1F1A74A9D9A53F7D5F6CDA3CBE89D337FC4FE1029A4975177CC33F249405A5DDB3965EAA4384AE6179BFAF73A974DFBFDA9692AE233E50501EBEB2F4DE43183314266FF882ACE110DB1E247C8415F1B7C5DCDB2DA43F11CDB08F2F28590912CA5C46C58F5F11C341B879F73775C3BF7E7E1F0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201806281059463_PopulateGenresTable'
BEGIN
    INSERT INTO Genres (Id, Name)
                        VALUES
                            (1, 'Comedy'),
                            (2, 'Action'),
                            (3, 'Horror'),
                            (4, 'Thriller'),
                            (5, 'Family'),
                            (6, 'Romance')
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201806281059463_PopulateGenresTable', N'EFReview.Migrations.Configuration',  0x1F8B0800000000000400DD59CD6EE33610BE17E83B083AB545D64AB29736B0779175E2C2E8E6077112F41630D2D8214A512A49B9768B3E590F7DA4BE4287FA172959B2BBC8B64580C026E77F3E0E67E8BFFEF873FC7E1332670D42D2884FDC93D1B1EB00F7A380F2D5C44DD4F2CDB7EEFB775F7E31BE0CC28DF358D0BDD574C8C9E5C47D512A3EF33CE9BF4048E428A4BE8864B454233F0A3D1244DEE9F1F177DEC9890728C245598E33BE4BB8A221A45FF0EB34E23EC42A21EC2A0A80C97C1D7716A954E79A842063E2C3C4BD9CDDC19AC22FAE73CE2841FD0B604BD7219C478A28B4EEEC41C2428988AF16312E1076BF8D01E9968449C8AD3EABC8873A707CAA1DF02AC642949F4815857B0A3C799B47C433D90F8AAB5B460C637689B1555BED751AB789FB3D70819E9B9ACEA64C68AA2AA6A394F2C829BE1F95194760E8BF23679A3095089870489420ECC8B94D9E19F57F80ED7DF413F0094F18AB5B83F6E05E6301976E45148350DB3B58E636CE03D7F19A7C9EC958B2D57832073E6C153A788DBAC9338332D7DE4E76FDBF10808041C4BBCE15D97C04BE522F13173FBACE8C6E20285672A90F9CE201412625125BC93559D3551A5F43DD230D2092AE73072CDD962F34CED03B4AB79ED2E023C14C44E15DC40A967CFDE99E88152834386AD95C4489F00D63C65E85849DF848250DC2474AF91FC4C79CABB7A72D00A939BB5091008C2608A220B8254A81E05A06A4E1FA3C60329420748048B820AAD4A53FDFD37000FA3B8159E0EE506016D86B056681DA21C03C9732F2696A431D9985FEA63B973C7076199365A27402B381C8A4316211354FDC6FACF874082C8F5D2530AFA73B058EBD9A37F6E9C31B4F118A60AB1CFD355D848D6A398978A5E58751E648316DD74217A08C9456716E9A6EB9DE642F4A95C59E87D260AF796AC828A1532369839679FE7B925BDA5B99EA0D1451A4B326A2B0D12C2F4DB75AF05B26B1EA57BCAC61291A1BAFA3B3195F9138C61A51EB74F2156791B539D3378BFD3B813093E1F9B2A52128AD2D3561C5232B307651355A3AA3422AAC2DE499E852320D428BAC01D90E3C15AA1AA8B43355A0AC20D79F3396666762B256619BA1272156EAD42930936BF3A5AD256144B45C19D3882521EFBA7676716797409D3F5BB1258C3DC37033289E1515039D668C0765203F2D0765203BFBFB67A083EF7367A04B42E38EAD0B6A6CBC7E469BD5A825AD65ADEDCA5D49D09AA1D683A2AB685B1B6B14643B1883529B896A4BB00E46A9784F9BF20A7FA04DA9903D6D32AF0A3B7FD68D619294E8296F0EE38618E7D5BA7F40B6CA7746E23A68FB1A0385A57BB1950AC29126182D7E66534611AF15C115E1740952651DBB8BD3EAA9316DFF7B265F4FCA800D197F5F7DE650946FA90EEB3F184BF99A08FF8588AF42B2F9BA2EC99E16F69CF65E3D1C69287A87ACD789D5A0C92AC0CFAA7FB2DA2FEE07637147ADB489BB8A587FBE2A35B5AC59E3C89C07B099B8BFA54C67CEFCC7A782EFC8B9115841CE9C63E7F7BDB359996D9CA0010614BC7B1870D818DA7AE799D346FFFC79625DB537FC0241A8C039F7B3623A25D227811D357D0FEDD49E0F79A60943C656FD360B4B10FA3C1286D79554022F2CAB99B91594FB3426ACE1B57DE70EA922DAA5529EB9730131705D1E6C078768DBD56294A28DF0F605A073B4EF014E5B63524B9D9DB5D684FDCF80333C95AF0B9C5D7DE027074EFB9B903D870F78F4E97EF3C9DA40BCD79E7579CAAA62C7D347EB7B50F773509BE4F6779976C95D86D7373B7574B8D0FB26553E26ED7E9AEA1871EC826F4DBCBD4F520DB7CD416CF86BD420678B67AF1E67DB6727BB48590F2CAFE5EC1E4F6FF6C08427B4F6BB23560849579508FD2B2407BF71364B9A395F464591302C2A488C66E60A14C116929C0B4597C457B8ED8394E90F038F84257A3C0F9F2198F39B44C5894297217C668D1F1A74A9D9A53F7D5F6CDA3CBE89D337FC4FE1029A4975177CC33F249405A5DDB3965EAA4384AE6179BFAF73A974DFBFDA9692AE233E50501EBEB2F4DE43183314266FF882ACE110DB1E247C8415F1B7C5DCDB2DA43F11CDB08F2F28590912CA5C46C58F5F11C341B879F73775C3BF7E7E1F0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201806281110013_ChangeVideosToOneToOneGenre'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Videos_Video_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id]
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Video_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Video_Id] ON [dbo].[VideoGenres]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]
    ALTER TABLE [dbo].[Videos] ADD [Genres_Id] [tinyint]
    CREATE INDEX [IX_Genres_Id] ON [dbo].[Videos]([Genres_Id])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genres_Id] FOREIGN KEY ([Genres_Id]) REFERENCES [dbo].[Genres] ([Id])
    DROP TABLE [dbo].[VideoGenres]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201806281110013_ChangeVideosToOneToOneGenre', N'EFReview.Migrations.Configuration',  0x1F8B0800000000000400D559DB6EE336107D2FD07F10F4D41659CBC9BEB486BD8BAC9314463717C449D0B78096C60E518A5249CAB55BF4CBFAD04FEA2F74A80B2551922DBBDD6C8B05163639339CCBE1708EF3D71F7F8EDF6F42E6AC41481AF1897B3A18BA0E703F0A285F4DDC442DDF7CEBBE7FF7E517E3CB20DC384F85DC5B2D879A5C4EDC17A5E291E749FF0542220721F54524A3A51AF851E89120F2CE86C3EFBCD3530FD0848BB61C677C9F70454348BFE0D769C47D885542D875140093F93AEECC53ABCE0D0941C6C487897B79750F6B0ABFB8CE39A304CF9F035BBA0EE13C5244A177A34709732522BE9AC7B840D8C33606945B122621F77A548AF70D6078A603F04AC5C2949F481585071A3C7D9B67C4B3D58FCAAB6B328639BBC4DCAAAD8E3ACDDBC4FD1EB8C0C8ED93465326B45499D3412A79E214DF4F4CC51118FADF89334D984A044C38244A1076E2DC250B46FD1F60FB10FD047CC213C6AADEA03FB8575BC0A53B11C520D4F61E96B98FB3C075BCBA9E672B1AB58A4E16C087ADC2006FF06CB260606AEDED54D7FF170610308878D7B9269B8FC057EA65E2E247D7B9A21B088A95DCEA23A77841504989A479C80D59D3559A5FEBB8271A40245DE71E58BA2D5F689CA177906E3DA7C947812B1185F7112B54F2F5E7072256A0D0E1A865731E25C2B79C197B251276E223B5D40B1FA9E4FF101F33AEDE9EB500A412EC5C4502309B208882E08E2805826B1B90A6EBF380C93A04A10344C20551E62CFDF981863DD0DF09CC0277C702B3C05E2B300BD4F601E6B994914F531FAAC82CCEAF8773C90367973359254C10580D44268D118B78F2C4FDA6919F0E83E6DA9506F37E5A37381C0C4EED302B01352F203E7A8A50C45B19EBAFE9226C54CB65C4572DBF8F32078BEDBE363A076555B54C75DDFB46F475F5A25B35D4F36C5AEA95482D1B063D15913674D92D604F7D8DBFA5AB5E4F1345452B260A1FED0E530FAB05C2A688E5C8E265334B31DB781DC3CDF89AC431B689CAB093AF38F36CD299BE991F3E0C84990DCF972D3381F1D69C844D8FACC0DAC5A3D1D32B2AA4C2F64216447793691036C46A90EDC05371540D95CD4A15282BC4F5E74CA53E9CD8AA65DAAE3092109B751A14D8C56DEAA5D3256144B4BC1AD3882521EF7A79766967EF40553F5B695A187B96E37652BC46562C74DA39EE5581FCB61C5581ECEE1F5E810EBDCF5D812E0BB567B66AA8B6F1FA15AD77A396B29A5EDB553B23D0AB42BA81B60DB156236DE6A1575573236DC5D58930271FE854FE401CE9D4C1DE60F70B683AB1CCA49EC0CCF4D52B54FB856996BDF1D0D8220674E6C1B11E9671DEE4F753EB46D7CF445C07835F638EB1E3CFB7524138D00283F9CF6CCA28C2BC14B8269C2E41AA6CD67791E79E593CFDBFC3993D2903D68738BF3A5B51946FA94EEB3F20B47C4D84FF42C45721D97C5DB5D4E41907F2C4574F479A8ABDF4EC7572D58B9305F859F5E264AD4CECB905090D3A30E3016C26EE6FA9E6C899FDF86C944F9C5B817771E40C9DDF8FABFC91442C67168733A5E6AC7E0C8143BC81D070200CBBA55402FB65E309BE436AEED398B09ACFCDD7A20F8875028D3D7BE70262E01A9DB5B0FA1CB4F3613466ADEBB42FF803C9689300F4609BDD64337B48F0662C746533387670AE5622DACD43DB2CB713C24FCA516BF15758C75E52DA64B29F8685368700C44CE55778C4ABA4ABD2841E6C38F835B41899195F46056E2D8F0A11ABB35D8322D816C9B95074497C85DB3E4899FE4CF64458A227D57001C18CDF262A4E14860CE182D57E76D3E0DF757E4AB5EB3E8F6FE3F417AD7F23047493EACE7ECB3F249405C6EFAB6667EF32A16F55FE86E95A2AFD96ADB6C6D24DC47B1ACAD3679AC10384314363F296CFC91A8EF1ED51C24758117F5BCC72DD46F617A29EF6F105252B414299DB28F5F55F963CFDA7A5777F03A5ED1AAE8C1A0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201806281116219_AddClassificationToVideosTable'
BEGIN
    ALTER TABLE [dbo].[Videos] ADD [Classification] [int] NOT NULL DEFAULT 0
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201806281116219_AddClassificationToVideosTable', N'EFReview.Migrations.Configuration',  0x1F8B0800000000000400D559DD6EDB3614BE1FB0771074B50DA96527375B60B768DDB8305627419416BB2B68E9D82146511A49A5F6863DD92EF6487B851DEA879228D996DD36DD50A0B0C8730ECFCFC7F3C3FCF3D7DFE3179B88398F20248DF9C41D0D86AE033C8843CAD7133755AB673FBA2F9E7FFBCDF82A8C36CEFB92EE42D321279713F741A9E4D2F364F00011918388062296F14A0D8238F248187BE7C3E14FDE68E4018A705196E38CEF52AE6804D9077E4E631E40A252C21671084C16EBB8E367529D6B12814C480013F76A76078F143EBACE4B46099EEF035BB90EE13C5644A17697EF24F84AC47CED27B840D8FD3601A45B1126A1D0FAB222EF6BC0F05C1BE0558CA5A820952A8E8E1438BA283CE2D9EC27F9D5351E439F5DA16FD5565B9DF96DE2BE012ED072FBA4CB29139AAAF2E920A33C73CAEF3313710486FE77E64C53A65201130EA912849D39B7E992D1E067D8DEC7BF029FF094B1BA36A80FEE351670E956C40908B5BD8355A1E33C741DAFC9E7D98C86ADC6931BF06AABD0C06B3C9B2C1998587B7BD9F5FFA500040C22DE751664F316F85A3D4C5CFCE93A33BA81B05C29A4BEE3142F08322991B60FB9268F749DF9D73AEE3D0D2196AE73072CDB960F34C9D13BC8B63E64CE47829988A3BB98952CC5FA877B22D6A050E1B863D38F531158CA8CBD0A097BF19149EA858F8CF27F888F395717E71D00A919EBAB58007A13045110DE12A540702D0332777D1D30598720748048784D94394BFFBEA7D1F1E89F3222255DD1A0C83A85EA1A8EF6D621C93B215F22FA54C897A8EE847C791FFA413E8D6A80B70D9CCB1923EBAA46F4B8094D119F7E2510082108B645E0D421DB74F402A22588C2089F32ACDBAEF39EB0143F47ADB034A8DFC42C34B4E7FB696F75B4D06386FEA2EDE5DC9FF5C59752C601CDDC51CF2B658C9BE75DF1D0D917F00A8C45725AA01369826EC3E84EDC1F5A06EC1068926625B0A8864D81C3C160641B5933A89D3EB165518472E3333CF5F76C1136AA0340D893141892C555B7D5D7427D50D6CDA9E0DCD4BE657D93BDAC352DF6C29B167BCD524B86B9A13592AE1B6C27F003F135FA56AA7A3D459411AD892875B4EB43D3AC8E34618258359C5EDE71969DA9B7A3351D2F4892E05DADB5AAC58AE3E77DEAF4997F7C2B17E532BC40767474465B7312962CB2066B178F464D67544885C5812C89CE68D3306A913520BB034FE5510D54B62355A2AC24D7BF7396666B69B3566E9BA1251196DACC28B083DBE6CB6603C288E8A8F9D398A511DFD537ECE3CEAB789D3F5F694B187B96E2B653BC96572C74DA3EEE1581E2B69C1481FCEE1F1F811D7C5F3B02BB24349AA4BAA0C6467F7976B3501769EF3D3D4E9A39AE032C2683EF428421E815779D96BB061B2B3DB7FDD00B2B85902EC8684798938F54AA283B272A75B4369853439AF54173A97B67D357F632D5AE5BEDB0B7CA974D624067CA9855AEC645E938FCDCD2AA253989EBA0F18FE863AC23FE562A88069A60E0FFC6A68C22CC2B8205E1740552E5CDAE7B3E1C9D5B6F37FF9D77144FCA90F5794C79F209161B729C0DD4273D72F04722820722BE8BC8E6FBBAA4F6EC79E4DBC193BB2373C5C191FD697CD56B4E0FF1B7FA7C73FA2950A8651C0B53AD71658EC3E866E2FE91715E3AF35F3E18E633E746E0ADBE7486CE9FA761E8C441B1987C8E9FE4DAB3C42903262217840616619877254EF2B45DCC6F05E5014D086BE8DCAE3B7DAE8376A09167EFBC8604B8C679C3AC3E07ED2DB146AC75310F197FE4B0DC1E507A4CC3BB87E1BC24E11D5BEAC8E670DC3113760ECABBE7E42EC9DD03EB179DA11BF6D7A6A28343737BD2FE325372BB9D40CCD4FEC6837895745D89D02D1287A081164333E7ABB8C4ADA551496265B60528820996BC148AAE48A0703B00CC9AFA11B678C2BA8A9610CEF94DAA9254A1C9102D59E35157837FDFF9D9534053E7F14D92BD6A7E0E13504DAA6BC40D7F95D2DA53DDAC9DD97789D0B7AAA8863A964A57C5F5D648BA8E794F4185FB4C32B8872861284CDE709F3CC229BABD93F016D624D8965DE16E218703D174FBF835256B412259C8A8F8F113311C469BE7FF0281962681EA1C0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201807091934182_VideoAndGenreSchemaChanges'
BEGIN
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genres_Id' AND object_id = object_id(N'[dbo].[Videos]', N'U'))
        DROP INDEX [IX_Genres_Id] ON [dbo].[Videos]
    EXECUTE sp_rename @objname = N'dbo.Videos.Genres_Id', @newname = N'GenreId', @objtype = N'COLUMN'
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Genres')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var1 nvarchar(128)
    SELECT @var1 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var1 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var1 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var2 nvarchar(128)
    SELECT @var2 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Classification';
    IF @var2 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var2 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Classification] [tinyint] NOT NULL
    DECLARE @var3 nvarchar(128)
    SELECT @var3 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'GenreId';
    IF @var3 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var3 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [GenreId] [tinyint] NOT NULL
    CREATE INDEX [IX_GenreId] ON [dbo].[Videos]([GenreId])
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201807091934182_VideoAndGenreSchemaChanges', N'EFReview.Migrations.Configuration',  0x1F8B0800000000000400D559CD6EE33610BE17E83B083A1659CB71B0401BD8BBC83AF1C2E83A09A224E82DA0A5B14394A25492CADA2DFA643DF491FA0A1DEA5F94E42871364DB1C0C2226786F3F3CD7086F9E7AFBFC71F3701B31E40481AF2897D3818DA16702FF4295F4FEC58ADDEFD687FFCF0FD77E3333FD858B739DD91A6434E2E27F6BD52D1B1E348EF1E02220701F54428C3951A7861E0103F7446C3E14FCEE1A10328C246599635BE8AB9A201241FF8390DB907918A095B843E3099ADE38E9B48B5CE490032221E4CECB3D9153C50F86A5B278C123CDF05B6B22DC279A88842ED8E6F24B84A847CED46B840D8F53602A45B112621D3FAB824EF6BC070A40D704AC65C94174B15064F1478789479C431D99FE557BBF018FAEC0C7DABB6DAEAC46F13FB337081969B271D4F99D054A54F0709E581957F1F14114760E87F07D634662A1630E1102B41D88175192F19F57E86ED75F82BF0098F19AB6A83FAE05E6D01972E45188150DB2B58653ACE7DDB72EA7C8EC958B0557852033E6D151A788E6793258322D6CE4E76FD7F2E00018388B7AD05D97C01BE56F7137BF4FEBD6DCDE806FC7C25937AC3292608322911F738F59C3CD075E270E3FC5BEA43286DEB0A58B22DEF6994C2398DC35D4E3013617015B23C92D9FA9D1BC6C2D316842D9BD744AC41D595193B253476022691D10B3009E5FF103073AE8E462DB1AB18EBAA5000FA140451E05F12A540702D031277BD117419A7229680483825AA385CFFBEA6C1D3652578DA33C7A68C484957D4CB6A5BE60F8D7173EBD97994E8B9471EE5A9D29A477992F5CBA338A8649169E05CCE18599737518FF4AA8BD83FCF105D3E08B6453456825AF7F302822588CC0697326C0E6CEB96B0183F0F1B51A9517F0E995FD08E76D35EEA60A1C30AFAA3A693537756174FA40C3D9A78A31AFD3CC4F5F3CEB86FEDAA9B2516B31B72813EA4117A0D83DB666C87C00240A5C0AC82D605FED01088E50C84AE2784610F24317094AB66EDA3DCA311613B8C31787A564CEDE542BAB9730A11705DEC7698DCE7D8A28C34CF2E8E30EAF8636E193B151C346F32E451C851400D75FE3D59848D6A493BEC17B3CC9359D535A3AE85BAA08C7A5316813A8A1AA0A9B3E7D5A8C19E61C660AF586AA850D4B50A495BDD33DDFE485A14FA96963622F748225444E43A9A5775DDAC96E25A04B11C069C741AC8A706A7636C182F48146185AB8C11D98AE5A633C4F49DFBF4363B4865389E6CE9B60B6D8B93B07B206B3076F168D474468554782D9325D1F7C0D40F1A6435C876E0293FAA86CA66A47294E5E4FA77CA526FFB5B92396399A125812E04494B64E2A3C997CC6D8411D1D27E4D431607BCBB207573A70D55953F5D694A183B86E28DC2D3F08A814ED3C7BD22D0996E3D2290E6FED323D0C1F75F47A04B42AD3DAD0AAA6DF49757DC2D55599D174EB71CB355AB8A33F75E196F8D7A689214A71775D1A87FE3AC163DFEB6D2284E29896DA1BB1E10695898DCAD54100C34C1C0FD8D4D19457B4B8205E1740552A53DA73D1A1E8E8C879AB7F368E248E9B33E2F27AF3E9D62638C2DBADAEB45833F10E1DD13D19C3A770A7DE21BC1ABBB2671CBA3A3F9EBFBADD728EEE36FF502A378818F462F3BC7767A33B1FF48F88EADF92F7719EB817521303F8FADA1F5E70B4DF1FD50DA05A87D26B9FD66B7ACCF7ECD69ED35E6B3AE16E22D4E64CD2EB8C7C8D53D71A5D714E6D752C7358562FBECD23E8D750F636D923B469A6F3EA83547B39D9359CDB24AB3F84D46B1668B8198A9FC9107D12AE9BA14A1FFE4C3C1ABA1A5A099F35598A3D6D02827310AD40214C1E24A4E84A22BE229DCF6004B967E74CD9E97CE8225F8737E11AB28566832044B567BC4D5E0DF757E326FD6751E5F44C983E34B98806A527D3F5CF04F31AD3CA3CD5A4A6A87089D55D9ADA863A9F4EDB8DE1692CE43DE5350E6BEA2185C43103114262FB84B1EE039BADD48F8026BE26DF34EB15BC8E381A8BB7D7C4AC95A904066324A7EFC440CFBC1E6C3BF3E759AA6EB1C0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201807092000230_AddingTagsToVideo'
BEGIN
    CREATE TABLE [dbo].[Tags] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](255) NOT NULL,
        CONSTRAINT [PK_dbo.Tags] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoTags] (
        [TagId] [int] NOT NULL,
        [VideoId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoTags] PRIMARY KEY ([TagId], [VideoId])
    )
    CREATE INDEX [IX_TagId] ON [dbo].[VideoTags]([TagId])
    CREATE INDEX [IX_VideoId] ON [dbo].[VideoTags]([VideoId])
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Tags_TagId] FOREIGN KEY ([TagId]) REFERENCES [dbo].[Tags] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Videos_VideoId] FOREIGN KEY ([VideoId]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201807092000230_AddingTagsToVideo', N'EFReview.Migrations.Configuration',  0x1F8B0800000000000400ED1A5D6FDB36F07DC0FE83A0C7218DE20405B6C06E913A71116C4E82382DF656D012ED10A3284DA4327BC37ED91EF693F61776D4072591942C7F34E986A240119377C7FBE6F14EFFFCF5F7F0ED2AA4CE134E3889D8C81D1C9FB80E667E1410B61CB9A958BCFADE7DFBE6DB6F865741B8723E967067120E30191FB98F42C4E79EC7FD471C227E1C123F8978B410C77E147A2888BCD393931FBCC1C0C340C2055A8E33BC4F992021CE7EC0CF71C47C1C8B14D1691460CA8B75D89965549D1B14621E231F8FDCABC93D7E22F837D7B9A004C1F9334C17AE83188B0412C0DDF9078E672289D87216C302A20FEB1803DC02518E0BAECF2BF0BE029C9C4A01BC0AB124E5A75C44E19604076785463C1D7D27BDBA4A63A0B32BD0AD584BA933BD8DDCF7982520B97ED2F9982612AAD2E9710679E494BF8F94C5C131E4BF23679C52912678C4702A12448F9CBB744E89FF235E3F44BF60366229A5756E801FD86B2CC0D25D12C53811EB7BBC2878BC0E5CC76BE2793AA242ABE1E402BC5B0B10F006CE46738A95ADBD4E74F97F49001C063CDE75A668F513664BF138724F5FBF769D0959E1A05C29A87E60040204904492F638F5063D9165A670EDFC8F24C011779D7B4CB36DFE48E2DC9D733B7C2A01264914DE47B4B464B1FE6916A5892F25882C9B0F285962D16466E855AED1E930198D5E0E9341FE071DE69A89B3538BED6AC2CE449460D0294E90C0C11D1202274CD2C099BABE10EFD24E055FC288E34B24D4E1F2EF07126E4F2BF3A73D636C4C11E76441FC22B715FA903EAE6FED1C47199F7BC451192AD6382A83AC2F330F68696705362C8C54AB061BB52D1B13BD8319E8F40A6580FB1AC82F17C8BB5C131B7D4ABF222CEED6CFA7D2B0E6517AE45EF30905B75792F570B62689FDFD0EB41DE084AEC13AB56CD5D4F01487739C1432CC0885AAD7753E229AC2CF81618F06F4FB88060AF6B41BF64E9A0914A6E0CF4C25E7EAAC2F5E701EF924D34615B7A5719BA75DB1C069B7749560B3C09F82F6480CFA02B38EDCEF0CD6ADC4542AAA8815254127B9A15793A25BB846626EE3C85EED543C15756D9327D3922D04771452BE5EF002273279200A2F170E5E499830131D613E8911ED1046C3E9991EA5A215757DE712C798C9CCD621729F63D5E56F9EAD8ED092F626B5B4BA479E74004700868A23E0F9F76C11AF8425A7C02BAF482BBC48B1BAD525D119165A955065B8A617194ED3442FD3AC815EF8CC06F4BC2C3090B310D5506B4A6AE0AB4C5F0330EF01DD5A9DC9427159326818BB333DD4D04BDEF48BBC294C0F419B159B296A7BE2D89C3A6AFC96DED021B03559EC237279BB2A47AFDA1C5EDEE728FB215E4B43643845710C575CAD4152AC38B3BC3B327E35DBBE8110E6343C9F5BFA088A5B751294536889B55D381A389D90840B7870A0399285C038080DB04658B7044D795423724D4B95C15482CBBF73946643C392F00A94094812CA6499D588BA7F987859470A519458EAD17144D390B527ED76ECBCC2ACE3E72B2685A1A7316E2467432B9A77EA3AEE6581D670EB61813C3F6E6F8116BC97B6401B85C6C3BB4EA8B1D19F9EBA7FEBB45A2FE5763A7AAD5E27A7EF7D31FE965D463B799BBC50B7F7352BD64B7BDAE7D67DF39E320CA0EE60BB96D5B64597D6D09537ABD92BD95810F7320110B297AAB533B762A7B550EEC54E46643B86F4B2C1B498513DE820CA5F5415A1550BC3E2E6DE3C6331AEF21CC47580F727100EAEF1D99A0B1C1E4B80E3D9AF744C0978680530458C2C3017F913DD3D3D199C6A039B2F6778E2711ED03E1394676F6E09C2D644AA758FC9067B4289FF8812B369D54974CB59C1B3AB2653CBC6CEDEF3EBAD574B3E80BFC5015AF2CA3F8CD7F1353CD05723F78F0CEFDCB9FEF953817AE4DC26109FE7CE89F3E781BAF9FDBC74AB7EF55777DA416B3B4762DBF56942B6DC6C9B355D1C5153760F97CD90F67258C5EF760717685B1CDD66A7AEB6AEB5E869765C36F57307469575CB2E21DF08EC5CF8F97D3A46DC4781A929598A749C5CB4B59AC77FCEFEA8BD723F783FB4AD3CDD2A300EDF02EDF4135B355AB396692AAB9DFE47BED2DF82CFE92D1D65FF33F84BFF89CA7E33949EDE76C8A9C97358BABF995F7E3262765ABB870F858DDB261FF9E30EAAD2B9B46B7EC5D9FBE3F6A948FB50C446B9A56D6E1998B4CD4B6C546DE30B1BCD3686ABAD569EAD476C18D6A8D143D7CCA6A5F9A157025ABF6AC3ACA62168B331B3FF90C6320BEA14D0DE4E31938AD1FE7D49210F398932674F9DA2F554C761664D6657081256EDFB5C48959C2C2B12F26B5D86FD46AA5230D76C11952953E3A804D14AF4291608DEC3E8221164817C01DB3E8657A6FCCCA6F880E22A9CE3E09ADDA6224E05888CC3396D7CB623336FD7F9D940ADC9F3F036CE3EA6398408C026914FFA5BF62E25B50F45269677420B0999D28B97A7B4A5902FD0E55A51BA89584F4285FAD44DF480C39802317ECB66E809EFC2DB078E7FC24BE4AFCBE65E3B91CD8668AA7D7849D03241212F6854F8F0137C3808576FFE05E9CD570EA62E0000 , N'6.2.0-61023')
END

